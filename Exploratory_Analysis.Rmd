---
title: "Exploratory Analysis"
output: 
  html_document:
    toc: true
    toc_float: true
---
```{r setup, include = FALSE}
library (tidyverse)
library (readxl)
library(plotly)
library(esquisse)


knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

```

# **1. The vaccination coverage in NYC by Zipcode and Borough**

```{r, include=FALSE}
merged_vaccine_data = read_csv(file="./data/merged_vaccine_data.csv")
```

### Fully vaccinated individuals by zipcode and boroughs:
```{r, echo=FALSE}
ggplot(merged_vaccine_data) +
  aes(
    x = modzcta,
    y = count_Fully_prop,
    colour = borough
  ) +
  geom_point(shape = "circle", size = 1.5) +
  scale_color_hue(direction = 1) +
  labs(
    x = "Zip Codes",
    y = "Proportion Fully Vaccinated",
    title = "Proportion fully Vaccinated in each Zipcode across Boroughs",
    subtitle = "(The horizontal line at 1 indicates 100% have received a 2 doses of an FDA-approved primary vaccine series)",
    color = "Boroughs"
  ) +
  theme_minimal() + geom_hline(yintercept=1, linetype="solid",  color = "navy", size=0.5)
```

### Additional/Booster vaccinated individuals by zipcode and boroughs:
```{r, echo=FALSE}
ggplot(merged_vaccine_data) +
  aes(
    x = modzcta,
    y = count_Additional_prop,
    colour = borough
  ) +
  geom_point(shape = "circle", size = 1.5) +
  scale_color_hue(direction = 1) +
  labs(
    x = "Zip Codes",
    y = "Proportion Boosted",
    title = "Proportion Boosted in each Zipcode across Boroughs",
    subtitle = "(The horizontal line at 1 indicates 100% have received a booster)",
    color = "Boroughs"
  ) + theme_minimal() + geom_hline(yintercept=1, linetype="solid",  color = "navy", size=0.5)
```

# **2. The Education Attainment in NYC by Vaccination Status and Borough**

```{r, include=FALSE}
cleaned_edu_booster_dataset = read_csv(file="./data/cleaned_edu_booster_dataset.csv")
```

### Fully Vaccinated Inidividuals by Education Status and Age

``` {r}
ggplot(cleaned_edu_booster_dataset) +
  aes(x = edu_prop, y = fully_vaccinated_prop, colour = edu) +
  geom_point(shape = "circle", size = 1.5) +
  scale_color_hue(direction = 1) +
  labs(
    x = "Proportion of Individuals by Education Status",
    y = "Proportion of Individuals Fully Vaccinated ",
    title = "Fully Vaccinated Individuals by Education Status and Age",
    color = "Education Status"
  ) +
  theme_minimal() +
  facet_wrap(vars(age))
```

### Fully Vaccinated Individuals by Education Status and Boroughs
```{r}
ggplot(cleaned_edu_booster_dataset) +
  aes(x = edu_prop, y = booster_prop, colour = borough) +
  geom_point(shape = "circle", size = 1.5) +
  scale_color_hue(direction = 1) +
  labs(
    x = "Education Status",
    y = "Proportion of individuals receiving boosters",
    title = "Additional/Boosted individuals by Education Status and Borough",
    color = "Boroughs"
  ) +
  theme_minimal() +
  facet_wrap(vars(edu))

```

### Additional/Boosted Inidividuals by Education Status and Boroughs
```{r}
ggplot(cleaned_edu_booster_dataset) +
  aes(x = edu_prop, y = booster_prop, colour = borough) +
  geom_point(shape = "circle", size = 1.5) +
  scale_color_hue(direction = 1) +
  labs(
    x = "Education Status",
    y = "Proportion of individuals receiving boosters",
    title = "Additional/Boosted individuals by Education Status and Borough",
    color = "Boroughs"
  ) +
  theme_minimal() +
  facet_wrap(vars(edu))

```





